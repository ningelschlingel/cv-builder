<div class="relative w-[210mm] h-[297mm] bg-white grid grid-cols-[280px_1fr] overflow-hidden text-zinc-900 group/page text-left items-start">
  
  <aside class="h-full flex flex-col bg-zinc-50/50 border-r border-zinc-100" [style.backgroundColor]="accentColor() + '05'">
    <div class="w-full aspect-[2/3] bg-zinc-100 relative group/img cursor-pointer" (click)="isEditMode() && img.click()">
      @if (profileImage()) { <img [src]="profileImage()" class="w-full h-full object-cover"> }
      @else { <div class="flex h-full items-center justify-center text-[10px] font-bold text-zinc-400">UPLOAD PHOTO</div> }
      <input #img type="file" class="hidden" (change)="handleImage($event)">
    </div>

    <div class="p-8 flex flex-col gap-10 w-full min-w-[280px]">
      <section class="w-full">
        <h3 [attr.contenteditable]="isEditMode()" (input)="contactTitle.set($any($event.target).innerText)"
            class="text-[11px] font-black uppercase tracking-[0.2em] mb-4 outline-none" [style.color]="accentColor()">
          {{contactTitle()}}
        </h3>
        <div class="flex flex-col gap-3 text-[13px] text-zinc-600">
          <p [attr.contenteditable]="isEditMode()" class="outline-none hover:bg-zinc-100/50 min-h-[1em]">you@example.com</p>
        </div>
      </section>
    </div>
  </aside>

  <main #main class="relative p-14 flex flex-col gap-12 overflow-hidden items-start text-left">
    <header class="w-full text-left">
      <h1 [attr.contenteditable]="isEditMode()" class="text-7xl font-black uppercase tracking-tighter leading-[0.8] mb-4 outline-none border-b-8 border-transparent focus:border-zinc-100">
        YOUR NAME
      </h1>
      <h2 [attr.contenteditable]="isEditMode()" class="text-xl font-bold uppercase tracking-[0.4em] outline-none" [style.color]="accentColor()">
        JOB TITLE
      </h2>
    </header>

    <div class="w-full flex flex-col gap-12">
      @for (sec of sections(); track sec.id) {
        <div class="w-full">
          <h3 [attr.contenteditable]="isEditMode()" (input)="onInput(sec, 'title', $event)"
              class="text-[12px] font-black uppercase tracking-[0.3em] mb-8 border-b border-zinc-100 pb-2" [style.color]="accentColor()">
            {{sec.title}}
          </h3>

          @for (com of sec.companies; track com.id) {
            <div class="mb-10 w-full">
              <h4 [attr.contenteditable]="isEditMode()" (input)="onInput(com, 'name', $event)"
                  class="text-sm font-black uppercase text-zinc-400 mb-4 outline-none">
                {{com.name}}
              </h4>

              <div class="flex flex-col gap-8 border-l-2 ml-1 pl-8" [style.borderColor]="accentColor() + '20'">
                @for (role of com.roles; track role.id) {
                  <div class="relative group/role w-full">
                    <div class="flex justify-between items-start w-full mb-2">
                      <span [attr.contenteditable]="isEditMode()" (input)="onInput(role, 'role', $event)" class="font-bold text-lg outline-none">
                        {{role.role}}
                      </span>
                      <span [attr.contenteditable]="isEditMode()" (input)="onInput(role, 'date', $event)" class="text-[11px] font-bold text-zinc-400 mt-1 whitespace-nowrap">
                        {{role.date}}
                      </span>
                    </div>

                    <ul class="flex flex-col gap-2 mb-3">
                      @for (b of role.bullets; track b.id) {
                        <li class="flex gap-3 text-[13px] text-zinc-600">
                          <span [style.color]="accentColor()">â€¢</span>
                          <span [attr.contenteditable]="isEditMode()" (input)="onInput(b, 'text', $event)" class="outline-none w-full">{{b.text}}</span>
                        </li>
                      }
                    </ul>
                    @if (isEditMode()) {
                      <button (click)="addBullet(sec.id, com.id, role.id)" class="text-[9px] font-black uppercase text-zinc-300 hover:text-blue-500">+ ADD BULLET</button>
                    }
                  </div>
                }
                @if (isEditMode()) {
                  <button (click)="addRole(sec.id, com.id)" class="w-fit text-[10px] font-black uppercase text-zinc-400 hover:text-blue-500 py-1 border-b border-dashed border-zinc-200">+ ADD INTERNAL ROLE CHANGE</button>
                }
              </div>
            </div>
          }
          @if (isEditMode()) {
            <button (click)="addCompany(sec.id)" class="w-full py-3 bg-zinc-50 text-[10px] font-black uppercase text-zinc-400 hover:bg-zinc-100">+ ADD COMPANY BLOCK</button>
          }
        </div>
      }
    </div>

    <div class="absolute inset-0 border-8 border-red-500 pointer-events-none opacity-0 transition-opacity" [class.opacity-100]="main.scrollHeight > main.clientHeight"></div>
  </main>
</div>